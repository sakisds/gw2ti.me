function copyToClipboard(a){window.clipboardData&&clipboardData.setData&&clipboardData.setData("text",a)}function CountdownTimer(a,b,c){1==b&&(this.hours=0),1==c&&(this.seconds=0),this.target=a,b&&c?this.text="--:--:--":this.text="--:--"}function CountupTimer(a){this.target=a,this.text="--:--"}function RingArray(a){this.array=a,this.length=a.length}function getRawTime(a,b){return 60*a+b}function getTimeFromRaw(a){return{h:Math.floor(a/60),m:a%60}}function makeTimeText(a,b,c){if(null!=a){var d="";d=a>9?a.toString():"0"+a.toString()}var e="";if(e=b>9?b.toString():"0"+b.toString(),null!=c){var f="";f=c>9?c.toString():"0"+c.toString()}var g="";return null!=a&&(g+=d+":"),g+=e,null!=c&&(g+=":"+f),g}var app=angular.module("gw2-timer",["720kb.tooltips"]);app.config(function(a){a.options({size:"large",lazy:!0,showTrigger:"click",hideTrigger:"click",side:"bottom","try":!1})}),angular.module("gw2-timer").controller("LastBossesController",["schedule","$scope","$interval",function(a,b,c){function d(){b.bosses=a.getLastBosses(),b.bosses.forEach(function(a){a.timer=new CountupTimer(a.rawTime)})}function e(){var a=new Date;b.bosses.forEach(function(b){1==b.timer.tick(a)&&d()})}b.bosses=null,d(),e(),c(e,1e3)}]),angular.module("gw2-timer").controller("NextBossesController",["schedule","$scope","$interval",function(a,b,c){function d(){b.bosses=a.getNextBosses(),b.bosses.forEach(function(a){a.timer=new CountdownTimer(a.rawTime,!1,!0)})}function e(){var a=new Date;b.bosses.forEach(function(b){1==b.timer.tick(a)&&d()})}b.bosses=null,d(),e(),c(e,1e3)}]),angular.module("gw2-timer").controller("NextTimeListController",["schedule","bossInfo","$scope","$interval",function(a,b,c,d){function e(){c.bosses.forEach(function(b){var c=a.getNextOfBoss(b.name);b.localTime=c.localTime,b.timer=new CountdownTimer(c.rawTime,!0,!1)})}function f(){c.bosses.forEach(function(a){var b=new Date;1==a.timer.tick(b)&&e()})}c.bosses=[];for(var g in b)b.hasOwnProperty(g)&&c.bosses.push({name:b[g].name,timerText:"--:--:--"});c.bosses.sort(function(a,b){return a.name<b.name?-1:a.name>b.name?1:0}),e(),f(),d(f,2e4)}]),angular.module("gw2-timer").controller("UpcomingListController",["schedule","$scope","$interval",function(a,b,c){function d(){b.events=a.getUpcomingEvents(),b.events.forEach(function(a){a.timer=new CountdownTimer(a.rawTime,!0,!1)})}function e(){var a=new Date;b.events.forEach(function(b){1==b.timer.tick(a)&&d()})}b.events=null,d(),e(),c(e,2e4)}]),CountdownTimer.prototype.tick=function(a){var b=getRawTime(a.getUTCHours(),a.getUTCMinutes()),c=this.target-b;if(0>=c)return!0;var d=getTimeFromRaw(c);return null!=this.hours&&(this.hours=d.h),null!=this.seconds&&(this.seconds=59-a.getUTCSeconds()),this.text=makeTimeText(this.hours,d.m,this.seconds),!1},CountupTimer.prototype.tick=function(a){var b=getRawTime(a.getUTCHours(),a.getUTCMinutes()),c=b-this.target;if(c>=30)return!0;var d=getTimeFromRaw(c);return this.text=makeTimeText(null,d.m,a.getUTCSeconds()),!1},RingArray.prototype.get=function(a){for(;a>this.length-1;)a-=this.length-1;return this.array[a]},RingArray.prototype.getMany=function(a,b){for(var c=[],d=0;b>d;d++)c.push(this.get(a+d));return c},angular.module("gw2-timer").constant("bossInfo",{tequatl:{name:"Tequatl the Sunless",map:"Sparkfly Fen",hardcore:!0,icon:"img/bosses/tequatl.png",mapImage:"img/maps/tequatl.png",waypoint:"[&BNABAAA=]"},taidha:{name:"Taidha Covington",map:"Bloodtide Coast",hardcore:!1,icon:"img/bosses/taidha.png",waypoint:"[&BKgBAAA=]"},svanir:{name:"The Frozen Maw",map:"Wayfarer Foothills",hardcore:!1,icon:"img/bosses/svanir.png",mapImage:"img/maps/svanir.png",waypoint:"[&BE4DAAA=]"},megadestroyer:{name:"Megadestroyer",map:"Mount Maelstrom",hardcore:!1,icon:"img/bosses/megadestroyer.png",mapImage:"img/maps/megadestroyer.png",waypoint:"[&BM0CAAA=]"},behemoth:{name:"Shadow Behemoth",map:"Queensdale",hardcore:!1,icon:"img/bosses/behemoth.png",mapImage:"img/maps/behemoth.png",waypoint:"[&BPwAAAA=]"},golem:{name:"Golem Mark II",map:"Mount Maelstrom",hardcore:!1,icon:"img/bosses/golem.png",mapImage:"img/maps/golem.png",waypoint:"[&BNQCAAA=]"},karka:{name:"Karka Queen",map:"Southsun Cove",hardcore:!0,icon:"img/bosses/karka.png",mapImage:"img/maps/karka.png",waypoint:"[&BNcGAAA=]"},elemental:{name:"Fire Elemental",map:"Metrica Province",hardcore:!1,icon:"img/bosses/elemental.png",mapImage:"img/maps/elemental.png",waypoint:"[&BEYAAAA=]"},shatterer:{name:"The Shatterer",map:"Blazeridge Steppes",hardcore:!1,icon:"img/bosses/shatterer.png",mapImage:"img/maps/shatterer.png",waypoint:"[&BE4DAAA=]"},wurm:{name:"Great Jungle Wurm",map:"Caledon Forest",hardcore:!1,icon:"img/bosses/wurm.png",mapImage:"img/maps/wurm.png",waypoint:"[&BEEFAAA=]"},tripleTrouble:{name:"Triple Trouble",map:"Bloodtide Coast",hardcore:!0,icon:"img/bosses/tripletrouble.png",mapImage:"img/maps/tripleTrouble.png",waypoint:"[&BKoBAAA=]"},jormag:{name:"Claw of Jormag",map:"Frostgorge Sound",hardcore:!1,icon:"img/bosses/jormag.png",mapImage:"img/maps/jormag.png",waypoint:"[&BNQCAAA=]"},modniir:{name:"Modniir Ulgoth",map:"Harathi Hinterlands",hardcore:!1,icon:"img/bosses/modniir.png",mapImage:"img/maps/modniir.png",waypoint:"[&BLEAAAA=]"}}),angular.module("gw2-timer").service("schedule",["bossInfo",function(a){function b(a,b){return{name:a.boss[b].name,map:a.boss[b].map,hardcore:a.boss[b].hardcore,icon:a.boss[b].icon,localtime:a.localTime,rawTime:a.rawTime,waypoint:a.boss[b].waypoint,mapImage:a.boss[b].mapImage}}this.events=new RingArray([{h:0,m:0,boss:[a.tequatl,a.taidha]},{h:0,m:15,boss:[a.svanir]},{h:0,m:30,boss:[a.megadestroyer]},{h:0,m:45,boss:[a.elemental]},{h:1,m:0,boss:[a.tripleTrouble,a.shatterer]},{h:1,m:15,boss:[a.wurm]},{h:1,m:30,boss:[a.modniir]},{h:1,m:45,boss:[a.behemoth]},{h:2,m:0,boss:[a.karka,a.golem]},{h:2,m:15,boss:[a.svanir]},{h:2,m:30,boss:[a.jormag]},{h:2,m:45,boss:[a.elemental]},{h:3,m:0,boss:[a.tequatl,a.taidha]},{h:3,m:15,boss:[a.wurm]},{h:3,m:30,boss:[a.megadestroyer]},{h:3,m:45,boss:[a.behemoth]},{h:4,m:0,boss:[a.tripleTrouble,a.shatterer]},{h:4,m:15,boss:[a.svanir]},{h:4,m:30,boss:[a.modniir]},{h:4,m:45,boss:[a.elemental]},{h:5,m:0,boss:[a.golem]},{h:5,m:15,boss:[a.wurm]},{h:5,m:30,boss:[a.jormag]},{h:5,m:45,boss:[a.behemoth]},{h:6,m:0,boss:[a.karka,a.taidha]},{h:6,m:15,boss:[a.svanir]},{h:6,m:30,boss:[a.megadestroyer]},{h:6,m:45,boss:[a.elemental]},{h:7,m:0,boss:[a.tequatl,a.shatterer]},{h:7,m:15,boss:[a.wurm]},{h:7,m:30,boss:[a.modniir]},{h:7,m:45,boss:[a.behemoth]},{h:8,m:0,boss:[a.tripleTrouble,a.golem]},{h:8,m:15,boss:[a.svanir]},{h:8,m:30,boss:[a.jormag]},{h:8,m:45,boss:[a.elemental]},{h:9,m:0,boss:[a.taidha]},{h:9,m:15,boss:[a.wurm]},{h:9,m:30,boss:[a.megadestroyer]},{h:9,m:45,boss:[a.behemoth]},{h:10,m:0,boss:[a.shatterer]},{h:10,m:15,boss:[a.svanir]},{h:10,m:30,boss:[a.karka,a.modniir]},{h:10,m:45,boss:[a.elemental]},{h:11,m:0,boss:[a.golem]},{h:11,m:15,boss:[a.wurm]},{h:11,m:30,boss:[a.tequatl,a.jormag]},{h:11,m:45,boss:[a.behemoth]},{h:12,m:0,boss:[a.taidha]},{h:12,m:15,boss:[a.svanir]},{h:12,m:30,boss:[a.tripleTrouble,a.megadestroyer]},{h:12,m:45,boss:[a.elemental]},{h:13,m:0,boss:[a.shatterer]},{h:13,m:15,boss:[a.wurm]},{h:13,m:30,boss:[a.modniir]},{h:13,m:45,boss:[a.behemoth]},{h:14,m:0,boss:[a.golem]},{h:14,m:15,boss:[a.svanir]},{h:14,m:30,boss:[a.jormag]},{h:14,m:45,boss:[a.elemental]},{h:15,m:0,boss:[a.karka,a.taidha]},{h:15,m:15,boss:[a.wurm]},{h:15,m:30,boss:[a.megadestroyer]},{h:15,m:45,boss:[a.behemoth]},{h:16,m:0,boss:[a.tequatl,a.shatterer]},{h:16,m:15,boss:[a.svanir]},{h:16,m:30,boss:[a.modniir]},{h:16,m:45,boss:[a.elemental]},{h:17,m:0,boss:[a.tripleTrouble,a.golem]},{h:17,m:15,boss:[a.wurm]},{h:17,m:30,boss:[a.jormag]},{h:17,m:45,boss:[a.behemoth]},{h:18,m:0,boss:[a.karka,a.taidha]},{h:18,m:15,boss:[a.svanir]},{h:18,m:30,boss:[a.megadestroyer]},{h:18,m:45,boss:[a.elemental]},{h:19,m:0,boss:[a.tequatl,a.shatterer]},{h:19,m:15,boss:[a.wurm]},{h:19,m:30,boss:[a.modniir]},{h:19,m:45,boss:[a.behemoth]},{h:20,m:0,boss:[a.tripleTrouble,a.golem]},{h:20,m:15,boss:[a.svanir]},{h:20,m:30,boss:[a.jormag]},{h:20,m:45,boss:[a.elemental]},{h:21,m:0,boss:[a.taidha]},{h:21,m:15,boss:[a.wurm]},{h:21,m:30,boss:[a.megadestroyer]},{h:21,m:45,boss:[a.behemoth]},{h:22,m:0,boss:[a.shatterer]},{h:22,m:15,boss:[a.svanir]},{h:22,m:30,boss:[a.modniir]},{h:22,m:45,boss:[a.elemental]},{h:23,m:0,boss:[a.karka,a.golem]},{h:23,m:15,boss:[a.wurm]},{h:23,m:30,boss:[a.jormag]},{h:23,m:45,boss:[a.behemoth]}]),this.events.array.forEach(function(a){a.rawTime=getRawTime(a.h,a.m);var b=a.rawTime-(new Date).getTimezoneOffset();b>=1440&&(b-=1440);var c=getTimeFromRaw(b);a.localTime=makeTimeText(c.h,c.m,null)}),this.getNextBosses=function(){var a=new Date,c=a.getUTCHours(),d=a.getUTCMinutes();if(23==c&&d>45)return[b(events.get(0),0),b(events.get(0),1)];for(var e,f=getRawTime(c,d),g=0;g<this.events.length+1;g++)if(e=this.events.get(g),e.rawTime>f)return 2==e.boss.length?[b(this.events.get(g),0),b(this.events.get(g),1)]:[b(this.events.get(g),0),b(this.events.get(g+1),0)]},this.getLastBosses=function(){var a=new Date,c=a.getUTCHours(),d=a.getUTCMinutes(),e=getRawTime(c,d);if(23==c&&d>45)return[b(this.events.get(this.events.length-1),0),b(this.events.get(this.events.length-2),1)];for(var f=0;f<this.events.length;f++)if(this.events.get(f).rawTime>e)return 0==f?[b(this.events.get(this.events.length-1),0),b(this.events.get(this.events.length-2),1)]:1==f?[b(this.events.get(0),0),b(this.events.get(0),1)]:2==this.events.get(f-1).boss.length?[b(this.events.get(f-1),0),b(this.events.get(f-1),1)]:[b(this.events.get(f-1),0),b(this.events.get(f-2),0)]},this.getUpcomingEvents=function(){var a=new Date,b=a.getUTCHours(),c=a.getUTCMinutes(),d=getRawTime(b,c);if(23==b&&c>45)return this.events.getMany(0,13);for(var e,f=0;f<this.events.length;f++)if(e=this.events.get(f),e.rawTime>d)return 1==e.boss.length?this.events.getMany(f+2,13):this.events.getMany(f+1,13)},this.getNextOfBoss=function(a){for(var b=new Date,c=b.getUTCHours(),d=b.getUTCMinutes(),e=getRawTime(c,d),f=0;f<this.events.length;f++){var g=this.events.get(f),h=!1;if(g.boss.forEach(function(b){b.name===a&&(h=!0)}),h&&g.rawTime>=e)return g;f==this.events.length-1&&(e=0,f=-1)}}}]);
